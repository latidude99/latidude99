{% extends "snc/base.html" %}
{% load static %}
{% static "snc/" as static_base %}
{% load humanize %}

{#  ----------------------------------- INFO --------------------------------------------- #}
{% block content_right %}
    <div class="container-fluid">

        <div class="row mt-3" style="">

        </div>
        <div class="info_text" style="border-left: darkgrey solid 1px">
            <p>Setting things up:</p>
            <ul>
                <li>first you need to check the link - if the validation is successfull you will
                    see the item name and price
                </li>
                <li>then if you confirm that it is indeed correct the other part of the service
                    becomes active
                </li>

                <li> you will need to enter your name/nickname andthe email address to receive
                    price movement alerts
                </li>
                <li>you can choose how long you want to track the product and optionally enter
                    threshold for price movements, up and down
                </li>
                <li>after submitting the product for trcking you will receive an email with a
                    confirmation link
                </li>
                <li>you will need to confirm your email address by clicking on the confirmation
                    link, otherwise the tracking will not start
                </li>
            </ul>
        </div>
        <div class="info_text" style="border-left: darkgrey solid 1px">

            <p>
                Afterwards::
            </p>
            <ul>
                <li>
                    you will receive an email every time the price changes more than the upwards
                    or downwards thresholds
                </li>
                <li>
                    each email will include basic product information, your personal unique id
                    as well as track and stop codes
                </li>
                <li>
                    the prices are checked 5 times a day, this however will increase soon
                </li>
                <li>
                    you can see detailed product information and the price history by entering
                    the tracking code on the home page - price history is presented as a chart and a
                    table
                </li>
                <li>
                    you can stop tracking any product at any time by entering 'stop track'
                    code on the home page
                </li>
                <li>
                    you can see a list of all the product you have been tracking,
                    including stopped and expired ones
                </li>

            </ul>

        </div>
    </div>
    <hr>


{% endblock %}

{#  ----------------------------------- CHARTS --------------------------------------------- #}
{% block content_left %}

    <div id="zoomLevel"></div>
    <div id="map-canvas"></div>

    <script src="https://maps.googleapis.com/maps/api/js?key={{ google_api_key_dev_un }}&callback=initMap"></script>

    <script>

        var map;
        var infoWindow;

        function initialize() {
            var mapOptions = {
                zoom: 5,
                center: new google.maps.LatLng(0.00, 0.00),
                mapTypeId: google.maps.MapTypeId.ROAD
            };

            map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
            infoWindow = new google.maps.InfoWindow();
            var markers = [];


            var chart2_1_polygon = new google.maps.Polygon({
                paths: [
                    new google.maps.LatLng(48.16667, -13.78665),
                    new google.maps.LatLng(62.83405, -13.78665),
                    new google.maps.LatLng(62.83405, 3.41228),
                    new google.maps.LatLng(48.16667, 3.41228)],
                strokeColor: '#990033',
                strokeOpacity: 0.8,
                clickable: true,
                strokeWeight: '2',
                fillColor: '#990033',
                fillOpacity: '0.05',
                number: '2',
                type: 'chart',
                name: 'British Isles',
                scale: '1:1,500,000',
                zoomMax: '6',
                zoomMin: '3',
                map: map
                , zIndex: '6'
            });

            google.maps.event.addListener(chart2_1_polygon, 'click', showInfo);


            var marker_chart2_1_polygon = new google.maps.Marker({
                map: map,
                position: new google.maps.LatLng(48.16667, -12.9267035),
                icon: " ",
                draggable: false,
                clickable: true,
                visible: true,
                zoomMax: '6',
                zoomMin: '3',
                label: {
                    text: '2',
                    color: '#990033',
                    fontSize: '16px',
                    fontShadow: "6px",
                    fontWeight: "regular"
                }
            });

            markers.push(marker_chart2_1_polygon);

            var chart3_1_polygon = new google.maps.Polygon({
                paths: [
                    new google.maps.LatLng(-7.83333, 70.6539),
                    new google.maps.LatLng(-4.57842, 70.6539),
                    new google.maps.LatLng(-4.57842, 72.83333),
                    new google.maps.LatLng(-7.83333, 72.83333)],
                strokeColor: '#006622',
                strokeOpacity: 0.8,
                clickable: true,
                strokeWeight: '2',
                fillColor: '#006622',
                fillOpacity: '0.05',
                number: '3',
                type: 'chart',
                name: 'Chagos Archipelago',
                scale: '1:360,000',
                zoomMax: '8',
                zoomMin: '5',
                map: map
                , zIndex: '8'
            });

            google.maps.event.addListener(chart3_1_polygon, 'click', showInfo);


            var marker_chart3_1_polygon = new google.maps.Marker({
                map: map,
                position: new google.maps.LatLng(-7.83333, 70.76287149999999),
                icon: " ",
                draggable: false,
                clickable: true,
                visible: true,
                zoomMax: '8',
                zoomMin: '5',
                label: {
                    text: '3',
                    color: '#006622',
                    fontSize: '16px',
                    fontShadow: "6px",
                    fontWeight: "regular"
                }
            });

            markers.push(marker_chart3_1_polygon);

            var chart5_1_polygon = new google.maps.Polygon({
                paths: [
                    new google.maps.LatLng(11.65, 51.91667),
                    new google.maps.LatLng(13.66712, 51.91667),
                    new google.maps.LatLng(13.66712, 55.0663),
                    new google.maps.LatLng(11.65, 55.0663)],
                strokeColor: '#660066',
                strokeOpacity: 0.8,
                clickable: true,
                strokeWeight: '2',
                fillColor: '#660066',
                fillOpacity: '0.05',
                number: '5',
                type: 'chart',
                name: '`Abd Al Kuri to Suqutra (Socotra)',
                scale: '1:350,000',
                zoomMax: '8',
                zoomMin: '5',
                map: map
                , zIndex: '8'
            });

            google.maps.event.addListener(chart5_1_polygon, 'click', showInfo);


            var marker_chart5_1_polygon = new google.maps.Marker({
                map: map,
                position: new google.maps.LatLng(11.65, 52.074151500000006),
                icon: " ",
                draggable: false,
                clickable: true,
                visible: true,
                zoomMax: '8',
                zoomMin: '5',
                label: {
                    text: '5',
                    color: '#660066',
                    fontSize: '16px',
                    fontShadow: "6px",
                    fontWeight: "regular"
                }
            });

            markers.push(marker_chart5_1_polygon);

            var polygons = new Array(chart2_1_polygon, chart3_1_polygon, chart5_1_polygon,);

            google.maps.event.addListener(map, 'zoom_changed', function () {
                var zoom = map.getZoom();

                for (i = 0; i < polygons.length; i++) {
                    if (zoom < polygons[i].zoomMin)
                        polygons[i].setMap(null);
                    else if (zoom > polygons[i].zoomMax)
                        polygons[i].setMap(null);
                    else
                        polygons[i].setMap(map);
                }
                for (i = 0; i < markers.length; i++) {

                    if (zoom < markers[i].zoomMin)
                        markers[i].setMap(null);
                    else if (zoom > markers[i].zoomMax)
                        markers[i].setMap(null);
                    else
                        markers[i].setMap(map);
                }
                document.getElementById("zoomLevel").innerHTML = 'Zoom Level: ' + zoom;
            });

            var bounds = new google.maps.LatLngBounds();
            for (var i = 0; i < 1; i++) {
                var paths = polygons[i].getPaths();
                paths.forEach(function (path) {
                    var ar = path.getArray();
                    for (var i = 0, l = ar.length; i < l; i++) {
                        bounds.extend(ar[i]);
                    }
                })
            }
            map.fitBounds(bounds)
            map.setCenter(bounds.getCenter());
        }


        function showInfo(event) {
            var vertices = this.getPath();

            var chartInfo = '<b>' + this.number + '</b><br>' +
                '<sup>' + this.type + '</sup><br>' +
                this.name + '</b><br>' +
                this.scale + '</b><br>';


            infoWindow.setContent(chartInfo);
            infoWindow.setPosition(event.latLng);

            infoWindow.open(map);
        }

        google.maps.event.addDomListener(window, 'load', initialize);

    </script>





{% endblock %}
